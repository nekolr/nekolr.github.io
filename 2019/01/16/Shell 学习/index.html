<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/cat192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/cat72.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/cat48.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha256-/4UQcSmErDzPCMAiuOiWPVVsNN2s3ZY/NsmXNcj0IFc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.nekolr.com","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.15.0","exturl":false,"sidebar":{"position":"right","display":"hide","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"style":null,"show_result":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="在计算机科学中，Shell 俗称壳程序，用来区别于操作系统内核程序。Shell 首先是 UNIX&#x2F;Linux 下的脚本编程语言，它是解释执行的，无需提前编译。同时它也是一个程序，为使用者（用户或其他应用程序）提供与内核交互的操作界面，它接收用户命令，然后通过命令解析调用相应的应用程序。">
<meta property="og:type" content="article">
<meta property="og:title" content="Shell 学习">
<meta property="og:url" content="https://blog.nekolr.com/2019/01/16/Shell%20%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="nekolr&#39;s blog">
<meta property="og:description" content="在计算机科学中，Shell 俗称壳程序，用来区别于操作系统内核程序。Shell 首先是 UNIX&#x2F;Linux 下的脚本编程语言，它是解释执行的，无需提前编译。同时它也是一个程序，为使用者（用户或其他应用程序）提供与内核交互的操作界面，它接收用户命令，然后通过命令解析调用相应的应用程序。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/nekolr/image-hosting@201911242036/2019/01/16/Q4w.png">
<meta property="article:published_time" content="2019-01-16T09:33:00.000Z">
<meta property="article:modified_time" content="2023-04-09T12:56:28.994Z">
<meta property="article:author" content="nekolr">
<meta property="article:tag" content="Shell">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/nekolr/image-hosting@201911242036/2019/01/16/Q4w.png">


<link rel="canonical" href="https://blog.nekolr.com/2019/01/16/Shell%20%E5%AD%A6%E4%B9%A0/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://blog.nekolr.com/2019/01/16/Shell%20%E5%AD%A6%E4%B9%A0/","path":"2019/01/16/Shell 学习/","title":"Shell 学习"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Shell 学习 | nekolr's blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="nekolr's blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">nekolr's blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">爱吃咖喱棒的打字员DA☆ZE~</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section">Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section">Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section">Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section">Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B9%BF%E4%B9%89%E4%B8%8A%E7%9A%84-Shell"><span class="nav-number">1.</span> <span class="nav-text">广义上的 Shell</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Linux-%E4%B8%8B%E7%9A%84-Shell"><span class="nav-number">2.</span> <span class="nav-text">Linux 下的 Shell</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BF%9B%E5%85%A5-Shell"><span class="nav-number">3.</span> <span class="nav-text">进入 Shell</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Bash-Shell-%E7%9A%84%E6%93%8D%E4%BD%9C%E7%8E%AF%E5%A2%83"><span class="nav-number">4.</span> <span class="nav-text">Bash Shell 的操作环境</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%90%9C%E5%AF%BB%E9%A1%BA%E5%BA%8F"><span class="nav-number">4.1.</span> <span class="nav-text">命令搜寻顺序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#bash-%E7%9A%84%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">4.2.</span> <span class="nav-text">bash 的环境配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#login-shell"><span class="nav-number">4.2.1.</span> <span class="nav-text">login shell</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#source"><span class="nav-number">4.2.2.</span> <span class="nav-text">source</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#non-login-shell"><span class="nav-number">4.2.3.</span> <span class="nav-text">non-login shell</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">4.2.4.</span> <span class="nav-text">其他配置文件</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%86%85%E5%BB%BA%E5%91%BD%E4%BB%A4"><span class="nav-number">5.</span> <span class="nav-text">内建命令</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%9B%BF%E6%8D%A2"><span class="nav-number">6.</span> <span class="nav-text">命令替换</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E5%88%AB%E5%90%8D"><span class="nav-number">7.</span> <span class="nav-text">命令别名</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8E%86%E5%8F%B2%E5%91%BD%E4%BB%A4"><span class="nav-number">8.</span> <span class="nav-text">历史命令</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%B5%84%E6%BA%90%E9%99%90%E5%88%B6"><span class="nav-number">9.</span> <span class="nav-text">资源限制</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%98%E9%87%8F"><span class="nav-number">10.</span> <span class="nav-text">变量</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%E5%8F%8A%E8%B5%8B%E5%80%BC"><span class="nav-number">10.1.</span> <span class="nav-text">变量声明及赋值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E6%B5%8B%E8%AF%95%E4%B8%8E%E6%9B%BF%E6%8D%A2"><span class="nav-number">10.2.</span> <span class="nav-text">变量的测试与替换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%8F%98%E9%87%8F"><span class="nav-number">10.3.</span> <span class="nav-text">使用变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%AA%E8%AF%BB%E5%8F%98%E9%87%8F"><span class="nav-number">10.4.</span> <span class="nav-text">只读变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%8F%98%E9%87%8F"><span class="nav-number">10.5.</span> <span class="nav-text">删除变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">10.6.</span> <span class="nav-text">变量的作用域</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="nav-number">10.7.</span> <span class="nav-text">环境变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#bash-%E6%93%8D%E4%BD%9C%E6%8E%A5%E5%8F%A3%E6%9C%89%E5%85%B3%E7%9A%84%E5%8F%98%E9%87%8F"><span class="nav-number">10.8.</span> <span class="nav-text">bash 操作接口有关的变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F"><span class="nav-number">10.9.</span> <span class="nav-text">特殊变量</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">11.</span> <span class="nav-text">字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8B%BC%E6%8E%A5%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">11.1.</span> <span class="nav-text">拼接字符串</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6"><span class="nav-number">11.2.</span> <span class="nav-text">获取字符串长度</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%87%E7%89%87"><span class="nav-number">11.3.</span> <span class="nav-text">字符串切片</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E5%B0%8F%E5%86%99%E8%BD%AC%E6%8D%A2"><span class="nav-number">11.4.</span> <span class="nav-text">大小写转换</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E7%BB%84"><span class="nav-number">12.</span> <span class="nav-text">数组</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%95%B0%E7%BB%84"><span class="nav-number">12.1.</span> <span class="nav-text">定义数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96%E6%95%B0%E7%BB%84"><span class="nav-number">12.2.</span> <span class="nav-text">读取数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E7%BB%84%E9%95%BF%E5%BA%A6"><span class="nav-number">12.3.</span> <span class="nav-text">获取数组长度</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E7%BB%84%E5%85%83%E7%B4%A0"><span class="nav-number">12.4.</span> <span class="nav-text">删除数组元素</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E6%8B%BC%E6%8E%A5"><span class="nav-number">12.5.</span> <span class="nav-text">数组拼接</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E5%AE%A3%E5%91%8A"><span class="nav-number">13.</span> <span class="nav-text">变量宣告</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%94%AE%E7%9B%98%E8%AF%BB%E5%8F%96"><span class="nav-number">14.</span> <span class="nav-text">键盘读取</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%B5%81%E9%87%8D%E5%AF%BC%E5%90%91"><span class="nav-number">15.</span> <span class="nav-text">数据流重导向</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA"><span class="nav-number">15.1.</span> <span class="nav-text">标准输入和输出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9E%83%E5%9C%BE%E6%A1%B6"><span class="nav-number">15.2.</span> <span class="nav-text">垃圾桶</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E8%BF%90%E8%A1%8C%E7%9A%84%E5%88%A4%E6%96%AD%E4%BE%9D%E6%8D%AE"><span class="nav-number">16.</span> <span class="nav-text">命令运行的判断依据</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AE%A1%E7%BA%BF%E5%91%BD%E4%BB%A4"><span class="nav-number">17.</span> <span class="nav-text">管线命令</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#cut"><span class="nav-number">17.1.</span> <span class="nav-text">cut</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#grep"><span class="nav-number">17.2.</span> <span class="nav-text">grep</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sort"><span class="nav-number">17.3.</span> <span class="nav-text">sort</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#uniq"><span class="nav-number">17.4.</span> <span class="nav-text">uniq</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#wc"><span class="nav-number">17.5.</span> <span class="nav-text">wc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tee"><span class="nav-number">17.6.</span> <span class="nav-text">tee</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tr"><span class="nav-number">17.7.</span> <span class="nav-text">tr</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#col"><span class="nav-number">17.8.</span> <span class="nav-text">col</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">18.</span> <span class="nav-text">参考</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">nekolr</p>
  <div class="site-description" itemprop="description">爱吃咖喱棒的打字员DA☆ZE~</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">130</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">58</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/nekolr" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;nekolr" rel="noopener me" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:excalibll@163.com" title="E-Mail → mailto:excalibll@163.com" rel="noopener me" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.nekolr.com/2019/01/16/Shell%20%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="nekolr">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nekolr's blog">
      <meta itemprop="description" content="爱吃咖喱棒的打字员DA☆ZE~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Shell 学习 | nekolr's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Shell 学习
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-01-16 09:33:00" itemprop="dateCreated datePublished" datetime="2019-01-16T09:33:00+00:00">2019-01-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Shell/" itemprop="url" rel="index"><span itemprop="name">Shell</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>在计算机科学中，Shell 俗称壳程序，用来区别于操作系统内核程序。Shell 首先是 UNIX&#x2F;Linux 下的脚本编程语言，它是解释执行的，无需提前编译。同时它也是一个程序，为使用者（用户或其他应用程序）提供与内核交互的操作界面，它接收用户命令，然后通过命令解析调用相应的应用程序。  </p>
<span id="more"></span>  

<p><img src="https://cdn.jsdelivr.net/gh/nekolr/image-hosting@201911242036/2019/01/16/Q4w.png" alt="Linux 下的 Shell">  </p>
<h1 id="广义上的-Shell"><a href="#广义上的-Shell" class="headerlink" title="广义上的 Shell"></a>广义上的 Shell</h1><p>广义上讲，只要能够为使用者提供与内核交互的都可以认为是 Shell，因此 Shell 可以分为两大类：图形界面 Shell（GUI Shell）与命令行 Shell（CLI Shell）。  </p>
<p>图形界面 Shell 应用最广泛的要属 Windows 系列操作系统了，还有 Linux 的 X window manager，以及功能更加强大的 CDE、GNOME、KDE 等。</p>
<p>命令行 Shell 主要包括 MS-DOS 系统下的命令行，Windows NT 下的 cmd.exe，支持 .NET Framework 的 Windows NT 系统下的 Windows PowerShell 以及 UNIX&#x2F;Linux 系统下的 sh&#x2F;bash&#x2F;csh 等。  </p>
<blockquote>
<p>我们习惯性地把微软旗下所有的操作系统都叫做 Windows，但其实它们是有很大区别的。最初的 Windows 只是一个运行在 MS-DOS 下的图形界面，从 Windows 1.x&#x2F;2.x&#x2F;3.x 一直发展到 Windows 9x&#x2F;ME，期间从 Windows 95 开始，微软划时代地推出了混合的 16 位 &#x2F; 32 位操作系统，这个时候的 Windows 虽然图形界面是 32 位的，但是操作系统还是 DOS，仍然能够运行 16 位的 DOS 程序。后来微软放弃了 MS-DOS，推出了另一条产品线 Windows NT。早期的 Windows NT 是一种纯 32 位操作系统，这个时候的操作系统除了在加电启动时是运行在 16 位模式（实模式），其他时候都是运行在 32 位模式（保护模式）。虽然 Windows NT 已经告别了 DOS，但还是可以通过模拟来运行 DOS 程序，比如在 Windows 8 中运行 DOS 程序会提示安装 NTVDM 来模拟 DOS 程序运行时的环境。但是由于 64 位的 Windows 不支持 NTVDM，所以也就没有办法运行 DOS 程序了。  </p>
</blockquote>
<blockquote>
<p>那么我们平常口中说的在 Windows NT 中运行 DOS 命令又是什么意思呢？因为在 MS-DOS 中是通过一系列的命令与内核交互，早期和中期的 Windows 都可以执行这些命令，到了 Windows NT，这些命令的使用方式并没有发生变化，于是就沿用了执行 DOS 命令这一说法了，而实际上此时在执行这些命令时使用的只是 Windows NT 提供的一个叫 cmd.exe 的命令行辅助工具，跟 DOS 已经没有关系了。  </p>
</blockquote>
<h1 id="Linux-下的-Shell"><a href="#Linux-下的-Shell" class="headerlink" title="Linux 下的 Shell"></a>Linux 下的 Shell</h1><p>在 Linux 下有很多不同的 Shell，常见的有 sh、bash、csh、tcsh、ash 等，sh 已经被 bash 代替，<code>/bin/sh</code> 往往是指向 <code>/bin/bash</code> 的符号链接。我们可以通过 <code>cat /etc/shells</code> 命令来查看当前系统下可以使用的 Shell 有哪些。  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ cat /etc/shells</span><br><span class="line">/bin/sh</span><br><span class="line">/bin/bash</span><br><span class="line">/sbin/nologin</span><br><span class="line">/usr/bin/sh</span><br><span class="line">/usr/bin/bash</span><br><span class="line">/usr/sbin/nologin</span><br><span class="line">/bin/tcsh</span><br><span class="line">/bin/csh</span><br></pre></td></tr></table></figure>

<h1 id="进入-Shell"><a href="#进入-Shell" class="headerlink" title="进入 Shell"></a>进入 Shell</h1><p>一种进入 Shell 的方法是退出图形界面模式，进入控制台模式。现代的 Linux 操作系统在启动时会自动创建几个虚拟控制台（Virtual Console，在 Linux 系统内存中运行的虚拟终端），其中一个供图形桌面程序使用，其他的保留原生控制台的样子。例如：CentOS 在启动时会创建 6 个虚拟控制台，分别对应快捷键 <code>Ctrl + Alt + Fn(n=1,2,3,4,5,6)</code>，其中图形界面模式对应 <code>Ctrl + Alt + F1</code>。  </p>
<p>另一种方式就是使用 Linux 桌面环境提供的终端模拟包（Terminal emulation package），也就是我们常说的终端（Terminal），这样就可以在图形桌面中使用 Shell。  </p>
<h1 id="Bash-Shell-的操作环境"><a href="#Bash-Shell-的操作环境" class="headerlink" title="Bash Shell 的操作环境"></a>Bash Shell 的操作环境</h1><p>在登录主机时，屏幕会显示一些说明文字，比如告知我们 Linux 的版本等信息。我们习惯的环境变量、命令别名等在登录后也会被自动配置出来。这些都是 bash 在启动时通过读取环境配置文件来初始化的。  </p>
<h2 id="命令搜寻顺序"><a href="#命令搜寻顺序" class="headerlink" title="命令搜寻顺序"></a>命令搜寻顺序</h2><p>一个命令下达，它的搜寻顺序如下：  </p>
<ol>
<li>以相对或者绝对路径执行命令，比如 <code>/bin/ls</code> 或者 <code>./ls</code>。</li>
<li>以 alias 找到该命令执行。</li>
<li>由 bash 内建的命令来执行。</li>
<li>通过 <code>$PATH</code> 这个变量值的顺序找到第一个命令来执行。</li>
</ol>
<h2 id="bash-的环境配置文件"><a href="#bash-的环境配置文件" class="headerlink" title="bash 的环境配置文件"></a>bash 的环境配置文件</h2><p>在系统中有一些环境配置文件，在 bash 启动时会去读取这些文件来初始化 bash 的操作环境。而 shell 又有 login shell 和 non-login shell，不同的 shell 读取的配置也是有区别的。  </p>
<h3 id="login-shell"><a href="#login-shell" class="headerlink" title="login shell"></a>login shell</h3><p>login shell 指的是在获取 bash 时进行了完整的登录流程。比如，由 tty1 ~ tty6 登录，通过输入用户名和密码成功进入 bash。  </p>
<p>一般来说，login shell 只会读取两个文件，一个是 <code>/etc/profile</code>，它是系统整体的配置文件；另一个是用户的配置文件。  </p>
<p>在 <code>/etc/profile</code> 文件中，它会根据用户的 UID 去配置 PATH、MAIL、USER、HISTSIZE 等变量的值，然后设置用户的 umask 的值，最后读取 <code>/etc/profile.d/*.sh</code> 中的一系列文件。  </p>
<p>在读取完系统配置文件后，接下来就会去读取用户的配置文件。用户的配置文件按照读取的顺序分别为：<code>~/.bash_profile</code>、<code>~/.bash_login</code> 和 <code>~/.profile</code>，login shell 只会读取其中的某一个。如果在用户目录下存在 <code>.bashrc</code> 文件，则会读取该文件。  </p>
<h3 id="source"><a href="#source" class="headerlink" title="source"></a>source</h3><p>由于配置文件的内容是在取得 login shell 的时候才会读取，因此如果后续修改配置文件，就需要注销后重新登录才能生效。如果不想重新登录，可以使用 <code>source</code> 命令重新读取配置文件。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重新读取配置文件</span></span><br><span class="line">$ <span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>

<h3 id="non-login-shell"><a href="#non-login-shell" class="headerlink" title="non-login shell"></a>non-login shell</h3><p>non-login shell 是指在获取 bash 时没有进行登录流程。比如在图形桌面中使用 <code>Ctrl + Alt + T</code> 启动的 shell 就是 non-login shell，在使用 <code>su</code> 命令切换用户时，不加 <code>--login</code> 参数（使用 <code>su - 用户名</code> 或者 <code>su --login 用户名</code> 的方式获取到的是 login shell）获取到的也是 non-login shell。  </p>
<p>一般来说，non-login shell 只会读取 <code>~/.bashrc</code>，在该文件中除了会应用使用者的个人配置外，还会呼叫外部配置文件 <code>/etc/bashrc</code>（Red Hat 系统特有的），然后根据用户的 UID 设置 umask 和 PS1 的值，同时还会读取 <code>/etc/profile.d/*.sh</code> 中的一系列文件。  </p>
<h3 id="其他配置文件"><a href="#其他配置文件" class="headerlink" title="其他配置文件"></a>其他配置文件</h3><p>还有一些配置文件也会影响 bash 环境，比如 <code>~/.bash_logout</code> 就记录了当注销 bash 后系统将会执行的动作，默认情况下只是清除屏幕信息，当然我们可以自定义其他的动作。  </p>
<h1 id="内建命令"><a href="#内建命令" class="headerlink" title="内建命令"></a>内建命令</h1><p>bash 有很多的内建命令，这些命令可以在 bash 中直接使用。通常来说，内建命令会比外部命令执行得更快，执行外部命令时不但会触发磁盘 I&#x2F;O，还需要 fork 出一个单独的进程来执行，执行完成后再退出。而执行内建命令相当于调用当前 Shell 进程的一个函数。要判断一个命令是不是内建命令，一种方式是通过 Linux 的联机帮助文件查看，比如使用 <code>man cd</code> 查看 <code>cd</code> 这个命令的说明文档。还有一种方式是通过 <code>type</code> 这个内建命令查询。比如 <code>ls</code> 命令，则可以使用 <code>type ls</code> 来查看该命令是否是内建命令。  </p>
<h1 id="命令替换"><a href="#命令替换" class="headerlink" title="命令替换"></a>命令替换</h1><p>命令替换是指将命令的输出结果作为值赋给某个变量，在写法上有两种方式，一种是使用反引号，一种是使用 <code>$()</code>。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DATE_1=`<span class="built_in">date</span>`</span><br><span class="line">DATE_2=$(<span class="built_in">date</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$DATE_1</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$DATE_2</span></span><br></pre></td></tr></table></figure>

<p>如果被替换的命令的输出内容包括多行（即有换行符），或者含有多个连续的空白符，那么在输出变量时应该将变量用双引号包围，否则系统会使用默认的空白符来填充，这会导致换行无效，以及连续的空白符被压缩成一个，比如：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行 ls -l</span></span><br><span class="line">$ <span class="built_in">ls</span> -l</span><br><span class="line">total 28</span><br><span class="line">drwxr-xr-x  3 root root  20480 Jan 21 09:25 bin</span><br><span class="line">drwxr-xr-x  2 root root   4096 Oct 17 10:14 include</span><br><span class="line"><span class="comment"># 设置变量 LSL</span></span><br><span class="line">$ LSL=`<span class="built_in">ls</span> -l`</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$LSL</span></span><br><span class="line">total 28 drwxr-xr-x 3 root root 20480 Jan 21 09:25 bin drwxr-xr-x 2 root root 4096 Oct 17 10:14 include</span><br><span class="line"><span class="comment"># 使用双引号包裹</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$LSL</span>&quot;</span></span><br><span class="line">total 28</span><br><span class="line">drwxr-xr-x  3 root root  20480 Jan 21 09:25 bin</span><br><span class="line">drwxr-xr-x  2 root root   4096 Oct 17 10:14 include</span><br></pre></td></tr></table></figure>

<p>需要注意的是，使用 <code>$()</code> 相对清晰，且支持嵌套，但是 <code>$()</code> 仅在 bash 环境下有效。而反引号由于看起来与单引号类似，可能会对使用者造成困扰，但是反引号可以在多种 shell 环境中使用。  </p>
<h1 id="命令别名"><a href="#命令别名" class="headerlink" title="命令别名"></a>命令别名</h1><p><code>alias</code> 命令用来给命令创建别名，如果直接下达该命令不带任何参数，则会列出 shell 环境中使用的所有别名。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置别名</span></span><br><span class="line">$ <span class="built_in">alias</span> avalon=<span class="string">&quot;netstat -tunlp&quot;</span></span><br><span class="line"><span class="comment"># 删除别名</span></span><br><span class="line">$ <span class="built_in">unalias</span> avalon</span><br></pre></td></tr></table></figure>

<p>如果想要别名永久生效，需要把别名写入到用户目录下的 <code>.bashrc</code> 文件中。  </p>
<h1 id="历史命令"><a href="#历史命令" class="headerlink" title="历史命令"></a>历史命令</h1><p>历史命令记录的笔数与环境变量 <code>HISTFILESIZE</code> 的配置有关。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出当前内存中的所有 history 记录</span></span><br><span class="line">$ <span class="built_in">history</span></span><br><span class="line"><span class="comment"># 列出最近的 5 笔命令</span></span><br><span class="line">$ <span class="built_in">history</span> 5</span><br><span class="line"><span class="comment"># 立即将当前内存中 history 记录写入 ~/.bash_history 文件中</span></span><br><span class="line">$ <span class="built_in">history</span> -w</span><br><span class="line"><span class="comment"># 写入到指定的文件中</span></span><br><span class="line">$ <span class="built_in">history</span> -w ~/history_file</span><br><span class="line"><span class="comment"># 将当前内存中的 history 记录全部删除</span></span><br><span class="line">$ <span class="built_in">history</span> -c</span><br><span class="line"><span class="comment"># 从文件中读取记录到当前环境中</span></span><br><span class="line">$ <span class="built_in">history</span> -r ~/history_file</span><br><span class="line"><span class="comment"># 运行第 5 条命令</span></span><br><span class="line">$ !5</span><br><span class="line"><span class="comment"># 由最近的命令向前搜索，寻找符合的字串并运行</span></span><br><span class="line">$ !netstat</span><br><span class="line"><span class="comment"># 运行上一条命令，等同于按 ↑ 键后再回车</span></span><br><span class="line">$ !!</span><br></pre></td></tr></table></figure>

<h1 id="资源限制"><a href="#资源限制" class="headerlink" title="资源限制"></a>资源限制</h1><p>系统的可用资源是有限的，如果不限制用户和进程对系统资源的使用，则很容易造成资源耗尽。使用 <code>ulimit</code> 命令可以控制进程对可用资源的访问。  </p>
<p>默认情况下 Linux 系统的各个资源都做了软硬限制，其中硬限制的作用是控制软限制（即软限制不能高于硬限制）。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前系统的软限制</span></span><br><span class="line">$ <span class="built_in">ulimit</span> -a</span><br><span class="line"><span class="comment"># 查看当前系统的硬限制</span></span><br><span class="line">$ <span class="built_in">ulimit</span> -a -H</span><br><span class="line"><span class="comment"># core 文件大小，单位是 block，默认为 0，表示没限制</span></span><br><span class="line">core file size          (blocks, -c) 0</span><br><span class="line"><span class="comment"># 数据段大小，单位是 Kbyte，默认不做限制</span></span><br><span class="line">data seg size           (kbytes, -d) unlimited</span><br><span class="line"><span class="comment"># 调度优先级，默认为 0，表示没限制</span></span><br><span class="line">scheduling priority             (-e) 0</span><br><span class="line"><span class="comment"># 创建文件的大小，单位是 block，默认不做限制</span></span><br><span class="line">file size               (blocks, -f) unlimited</span><br><span class="line"><span class="comment"># 挂起的信号数量，默认是 8192</span></span><br><span class="line">pending signals                 (-i) 8192</span><br><span class="line"><span class="comment"># 最大锁定内存的值，单位是 Kbyte，默认是 32</span></span><br><span class="line">max locked memory       (kbytes, -l) 32</span><br><span class="line"><span class="comment"># 最大可用的常驻内存值，单位是 Kbyte，默认不做限制</span></span><br><span class="line">max memory size         (kbytes, -m) unlimited</span><br><span class="line"><span class="comment"># 最大打开的文件数，默认是 1024</span></span><br><span class="line">open files                      (-n) 1024</span><br><span class="line"><span class="comment"># 管道最大缓冲区的值</span></span><br><span class="line">pipe size            (512 bytes, -p) 8</span><br><span class="line"><span class="comment"># 消息队列的最大值，单位是 byte</span></span><br><span class="line">POSIX message queues     (bytes, -q) 819200</span><br><span class="line"><span class="comment"># 程序的实时性优先级，默认为 0</span></span><br><span class="line">real-time priority              (-r) 0</span><br><span class="line"><span class="comment"># 栈大小，单位是 Kbyte</span></span><br><span class="line">stack size              (kbytes, -s) 10240</span><br><span class="line"><span class="comment"># 最大 cpu 占用时间，默认不做限制</span></span><br><span class="line">cpu time               (seconds, -t) unlimited</span><br><span class="line"><span class="comment"># 用户最大进程数，默认是 8192</span></span><br><span class="line">max user processes              (-u) 8192</span><br><span class="line"><span class="comment"># 最大虚拟内存，单位是 Kbyte，默认不做限制</span></span><br><span class="line">virtual memory          (kbytes, -v) unlimited</span><br><span class="line"><span class="comment"># 文件锁，默认不做限制</span></span><br><span class="line">file locks                      (-x) unlimited</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置最大可以打开的文件数</span></span><br><span class="line"><span class="comment"># 该命令会同时设置软、硬限制</span></span><br><span class="line">$ <span class="built_in">ulimit</span> -n 4096</span><br><span class="line"><span class="comment"># 单独设置软限制</span></span><br><span class="line">$ <span class="built_in">ulimit</span> -S -n 4096</span><br><span class="line"><span class="comment"># 单独设置硬限制</span></span><br><span class="line">$ <span class="built_in">ulimit</span> -H -n 4096</span><br></pre></td></tr></table></figure>

<p>使用 <code>ulimit</code> 命令可以修改资源的限制，但是当用户注销后会失效。如果想永久生效，则需要修改 <code>/etc/security/limits.conf</code> 文件。  </p>
<h1 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h1><p>在 bash 中定义变量不需要指明变量的类型，每个变量的值都是字符串，即使在赋值时没有使用引号，它们也会被视为字符串。当然，在实际解释执行的过程中，如果需要进行算术运算，则会自动将值转化为整数（bash 不支持浮点类型的运算，除非借助于第三方工具）。</p>
<h2 id="变量声明及赋值"><a href="#变量声明及赋值" class="headerlink" title="变量声明及赋值"></a>变量声明及赋值</h2><p>变量命名时只能使用字母、数字和下划线，首字符不能以数字开头，同时不能使用 bash 里的关键字，比如：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义变量 your_name</span></span><br><span class="line">your_name=<span class="string">&quot;Alice&quot;</span></span><br><span class="line">your_name=Alice</span><br><span class="line">your_name=<span class="string">&#x27;Alice&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="变量的测试与替换"><a href="#变量的测试与替换" class="headerlink" title="变量的测试与替换"></a>变量的测试与替换</h2><p>有时候我们需要判断某个变量是否存在，并根据判断的结果进行选择性地赋值。  </p>
<table>
<thead>
<tr>
<th>参数设置表达式</th>
<th>str 没有设置</th>
<th>str 为空字符串</th>
<th>str 为非空字符串</th>
</tr>
</thead>
<tbody><tr>
<td>var&#x3D;${str-expr}</td>
<td>var&#x3D;expr</td>
<td>var&#x3D;</td>
<td>var&#x3D;$str</td>
</tr>
<tr>
<td>var&#x3D;${str:-expr}</td>
<td>var&#x3D;expr</td>
<td>var&#x3D;expr</td>
<td>var&#x3D;$str</td>
</tr>
<tr>
<td>var&#x3D;${str+expr}</td>
<td>var&#x3D;</td>
<td>var&#x3D;expr</td>
<td>var&#x3D;expr</td>
</tr>
<tr>
<td>var&#x3D;${str:+expr}</td>
<td>var&#x3D;</td>
<td>var&#x3D;</td>
<td>var&#x3D;expr</td>
</tr>
<tr>
<td>var&#x3D;${str&#x3D;expr}</td>
<td>str&#x3D;expr, var&#x3D;expr</td>
<td>str 不变, var&#x3D;</td>
<td>str 不变, var&#x3D;$str</td>
</tr>
<tr>
<td>var&#x3D;${str:&#x3D;expr}</td>
<td>str&#x3D;expr, var&#x3D;expr</td>
<td>str&#x3D;expr, var&#x3D;expr</td>
<td>str 不变, var&#x3D;$str</td>
</tr>
<tr>
<td>var&#x3D;${str?expr}</td>
<td>expr 输出至 stderr</td>
<td>var&#x3D;</td>
<td>var&#x3D;$str</td>
</tr>
<tr>
<td>var&#x3D;${str:?expr}</td>
<td>expr 输出至 stderr</td>
<td>expr 输出至 stderr</td>
<td>var&#x3D;$str</td>
</tr>
</tbody></table>
<h2 id="使用变量"><a href="#使用变量" class="headerlink" title="使用变量"></a>使用变量</h2><p>使用一个定义过的变量，只要在变量名前面加上 <code>$</code> 符号即可。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">your_name=<span class="string">&quot;Saber&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$your_name</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;your_name&#125;</span></span><br></pre></td></tr></table></figure>

<p>变量名外可以不使用花括号，加上花括号是为了帮助解释器识别变量的边界，比如：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> skill <span class="keyword">in</span> Ada Coffe Java;<span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;I am good at <span class="variable">$&#123;skill&#125;</span>Script&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h2 id="只读变量"><a href="#只读变量" class="headerlink" title="只读变量"></a>只读变量</h2><p>使用 <code>readonly</code> 命令可以将变量定义为只读的，只读变量的值不能被修改。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">myUrl=<span class="string">&quot;https://nekolr.com&quot;</span></span><br><span class="line"><span class="built_in">readonly</span> myUrl</span><br><span class="line"><span class="comment"># 或者直接定义</span></span><br><span class="line"><span class="built_in">readonly</span> myUrl=<span class="string">&quot;https://nekolr.com&quot;</span></span><br><span class="line"><span class="comment"># 或者使用 declare 命令来声明变量</span></span><br><span class="line"><span class="built_in">declare</span> -r myUrl=<span class="string">&quot;https://nekolr.com&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="删除变量"><a href="#删除变量" class="headerlink" title="删除变量"></a>删除变量</h2><p>使用 <code>unset</code> 命令可以删除变量，已经删除的变量无法再次使用，该命令无法删除只读变量。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">myUrl=<span class="string">&quot;https://nekolr.com&quot;</span></span><br><span class="line"><span class="built_in">unset</span> myUrl</span><br><span class="line"><span class="comment"># 不会有任何输出</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$myUrl</span></span><br></pre></td></tr></table></figure>

<h2 id="变量的作用域"><a href="#变量的作用域" class="headerlink" title="变量的作用域"></a>变量的作用域</h2><p>bash 中的变量根据作用范围划分共有三种，包括局部变量、全局变量和环境变量。  </p>
<ul>
<li>局部变量，只能在函数内部有效。使用 <code>local</code> 命令定义局部变量，该命令只能在函数中使用。如果在函数中没有使用该命令定义变量，那么变量会如同在 JavaScript 里没有使用 <code>var</code> 定义变量一样是全局变量。</li>
<li>全局变量，在当前 shell 进程中都可以使用，一般在 shell 中定义的变量，默认都是全局变量。</li>
<li>环境变量，可以在当前进程或者子进程中使用。</li>
</ul>
<h2 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h2><p>全局变量只能在当前 shell 进程中使用，如果使用 <code>export</code> 命令将它导出，那么它就可以在所有的子进程中使用了，这时它也就变成了环境变量。  </p>
<p>当登录 Linux 并取得一个 bash 之后，该 bash 就作为一个独立的进程存在。接下来在这个 bash 底下所下达的任何命令都会执行成为这个 bash 的子程序。<strong>子程序会继承父程序的环境变量，但是不会继承父程序的自定义变量。</strong>  </p>
<blockquote>
<p>需要注意的是，在父 shell 中创建的环境变量可以在所有的子程序中使用，但是如果使用终端创建一个新的 shell，那么它就不是当前 shell 的子进程，当前 shell 的环境变量对它也就无效了。  </p>
</blockquote>
<p>我们可以使用 <code>env</code> 命令查看当前 shell 环境下的所有环境变量，比如以下就是常见的环境变量。  </p>
<table>
<thead>
<tr>
<th>变量</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>HOME</td>
<td>表示用户的根目录。当我们使用 <code>cd</code> 或者 <code>cd ~</code> 命令时，取用的就是这个变量。</td>
</tr>
<tr>
<td>SHELL</td>
<td>表示当前 shell 环境使用的是什么 shell 程序，比如 Linux 默认使用的是 <code>/bin/bash</code>。</td>
</tr>
<tr>
<td>MAIL</td>
<td>当我们使用 mail 这个命令收信时，系统会去读取的邮件信箱文件。</td>
</tr>
<tr>
<td>PATH</td>
<td>运行文件时搜寻的路径，目录与目录中间以冒号分隔。</td>
</tr>
<tr>
<td>LANG</td>
<td>表示系统使用的语言。一般默认是 <code>en_US.UTF-8</code></td>
</tr>
</tbody></table>
<p>通过 <code>export 变量名</code> 的形式导出的是临时环境变量，当 shell 会话注销后会失效。如果想永久生效，一种是对当前用户永久生效，这种需要在当前的用户目录下的 <code>.bash_profile</code> 文件中新增变量并导出。另一种是对所有用户永久生效，这种则需要在 <code>/etc/profile</code> 文件中新增变量并导出。最后再使用 <code>source 文件名</code> 的方式通知当前 shell 读取并执行修改后的文件，使配置立即生效。  </p>
<h2 id="bash-操作接口有关的变量"><a href="#bash-操作接口有关的变量" class="headerlink" title="bash 操作接口有关的变量"></a>bash 操作接口有关的变量</h2><p>bash 中不光有环境变量，还有一些与 bash 操作接口有关的变量，以及用户自定义的变量，这些变量可以使用 <code>set</code> 命令查看，其中有几个比较重要的变量。  </p>
<p>**<code>PS1</code>**，当我们每次按下 [Enter] 按键去运行某个命令后，最后要再次出现提示字符时，就会主动去读取这个变量值。每个 distributions 的 bash 默认的 PS1 变量内容可能有些许的差异。举例来说，CentOS 下 PS1 的值为：<code>&#39;[\u@\h \W]\$ &#39;</code>，对应的命令提示符可能为：<code>[root@VM_59_13_centos ~]</code>，具体可以通过 <code>man bash</code> 命令查找这些符号的说明。  </p>
<p><strong><code>$</code></strong> 代表的是当前这个 shell 的进程号，亦即是所谓的 PID (Process ID)。使用 <code>echo $$</code> 命令可以查看当前 shell 的 PID。  </p>
<p><strong><code>?</code></strong> 代表的是上一个运行的命令所回传的值。当我们运行某些命令时，这些命令都会回传一个运行后的代码。一般来说，如果成功的运行该命令，则会回传一个 0 值；如果运行过程发生错误，就会回传错误代码，一般以非为 0 的数值表示，比如：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ehco <span class="variable">$SHELL</span></span><br><span class="line">/bin/bash</span><br><span class="line">$ <span class="built_in">echo</span> $?</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h2 id="特殊变量"><a href="#特殊变量" class="headerlink" title="特殊变量"></a>特殊变量</h2><table>
<thead>
<tr>
<th>变量</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>$0</code></td>
<td>当前脚本的文件名。</td>
</tr>
<tr>
<td><code>$n</code> (n≥1)</td>
<td>传递给脚本或函数的参数。n 是一个数字，表示第几个参数。例如，第一个参数是 $1，第二个参数是 $2。</td>
</tr>
<tr>
<td><code>$#</code></td>
<td>传递给脚本或函数的参数个数。</td>
</tr>
<tr>
<td><code>$*</code></td>
<td>传递给脚本或函数的所有参数。</td>
</tr>
<tr>
<td><code>$@</code></td>
<td>传递给脚本或函数的所有参数。当变量被双引号包含时，$@ 与 $* 稍有不同。比如传递了 3 个参数，那么对于 <code>&quot;$*&quot;</code> 来说，这 3 个参数会合并到一起形成一份数据，它们之间是无法分割的；而对于 <code>&quot;$@&quot;</code> 来说，这 3 个参数是相互独立的，它们是 3 份数据。</td>
</tr>
<tr>
<td><code>$?</code></td>
<td>上个命令的退出状态，或函数的返回值。0 表示没有错误，其他任何值表示有错误。</td>
</tr>
<tr>
<td><code>$$</code></td>
<td>当前 Shell 进程 ID。对于 Shell 脚本来说就是这些脚本所在的进程 ID。</td>
</tr>
</tbody></table>
<p>使用一个例子说明这些参数。编写脚本，并保存为 <code>test.sh</code>：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Process ID: $$&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;File Name: <span class="variable">$0</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;First Parameter: <span class="variable">$1</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Second Parameter: <span class="variable">$2</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;All parameters 1: <span class="variable">$@</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;All parameters 2: $*&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Total: <span class="variable">$#</span>&quot;</span></span><br></pre></td></tr></table></figure>

<p>接下来运行该脚本。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">chmod</span> +x ./test.sh</span><br><span class="line">$ ./test.sh Java Python</span><br><span class="line">Process ID: 18235</span><br><span class="line">File Name: ./test.sh</span><br><span class="line">First Parameter: Java</span><br><span class="line">Second Parameter: Python</span><br><span class="line">All parameters 1: Java Python</span><br><span class="line">All parameters 2: Java Python</span><br><span class="line">Total: 2</span><br></pre></td></tr></table></figure>

<h1 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h1><p>Shell 中的字符串可以用单引号或者是双引号表示，但是这两种方式是有区别的。  </p>
<p>使用单引号字符串，字符串里的内容都会原样输出，在里面使用变量是无效的；而使用双引号，则可以在里面使用变量，同时也支持转义。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">your_name=<span class="string">&#x27;Alice&#x27;</span></span><br><span class="line"><span class="comment"># 会原样输出</span></span><br><span class="line">str=<span class="string">&#x27;$&#123;str&#125;&#x27;</span></span><br><span class="line"><span class="comment"># 能够使用变量，并且支持转义</span></span><br><span class="line">str2=<span class="string">&quot;Hello, I kown your name is <span class="variable">$&#123;your_name&#125;</span>&quot;</span></span><br><span class="line"><span class="comment"># Hello, I kown your name is &quot;Alice&quot;</span></span><br><span class="line">str3=<span class="string">&quot;Hello, I kown your name is \&quot;<span class="variable">$&#123;your_name&#125;</span>\&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="拼接字符串"><a href="#拼接字符串" class="headerlink" title="拼接字符串"></a>拼接字符串</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">your_name=<span class="string">&#x27;Alice&#x27;</span></span><br><span class="line"><span class="comment"># 使用双引号拼接</span></span><br><span class="line">str=<span class="string">&quot;Hello, &quot;</span><span class="variable">$&#123;your_name&#125;</span><span class="string">&quot;!&quot;</span></span><br><span class="line"><span class="comment"># 使用单引号拼接</span></span><br><span class="line">str2=<span class="string">&#x27;Hello, &#x27;</span><span class="variable">$&#123;your_name&#125;</span><span class="string">&#x27;!&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="获取字符串长度"><a href="#获取字符串长度" class="headerlink" title="获取字符串长度"></a>获取字符串长度</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">your_name=<span class="string">&quot;Alice&quot;</span></span><br><span class="line"><span class="comment"># 长度为 5</span></span><br><span class="line"><span class="variable">$&#123;#your_name&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="字符串切片"><a href="#字符串切片" class="headerlink" title="字符串切片"></a>字符串切片</h2><p>具体的格式为：<code>$&#123;string: start: length&#125;</code>。这里需要注意的是，有从左或者从右两种计数方式，如果从左计数，则从 0 开始；如果从右开始计数，则从 1 开始。不管从左还是从右计数，截取始终是从左向右。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">your_name=<span class="string">&quot;Alice&quot;</span></span><br><span class="line"><span class="comment"># 截取的子串为 lice</span></span><br><span class="line"><span class="variable">$&#123;your_name: 1: 4&#125;</span></span><br><span class="line"><span class="comment"># 从右向左计数，取倒数第二个字符一直截取到末尾</span></span><br><span class="line"><span class="variable">$&#123;your_name: -2&#125;</span></span><br><span class="line"><span class="comment"># 等同于 $&#123;your_name: -2&#125;</span></span><br><span class="line"><span class="variable">$&#123;your_name: -2: 2&#125;</span></span><br></pre></td></tr></table></figure>

<p>复杂的，还可以根据指定的子串进行截取。  </p>
<table>
<thead>
<tr>
<th>表达式</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>${变量#关键词}</td>
<td>若变量内容从头开始的数据符合关键词，则将符合的最短数据删除</td>
</tr>
<tr>
<td>${变量##关键词}</td>
<td>若变量内容从头开始的数据符合关键词，则将符合的最长数据删除</td>
</tr>
<tr>
<td>${变量%关键词}</td>
<td>若变量内容从尾向前的数据符合关键词，则将符合的最短数据删除</td>
</tr>
<tr>
<td>${变量%%关键词}</td>
<td>若变量内容从尾向前的数据符合关键词，则将符合的最长数据删除</td>
</tr>
<tr>
<td>${变量&#x2F;旧字符串&#x2F;新字符串}</td>
<td>若变量内容中包含旧字符串，则变量中第一个旧字符串会被新字符串取代</td>
</tr>
<tr>
<td>${变量&#x2F;&#x2F;旧字符串&#x2F;新字符串}</td>
<td>若变量内容中包含旧字符串，则变量中全部的旧字符串会被新字符串取代</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">url=<span class="string">&quot;https://nekolr.com&quot;</span></span><br><span class="line"><span class="comment"># 截取的字符串为 //nekolr.com</span></span><br><span class="line"><span class="variable">$&#123;url#*:&#125;</span></span><br><span class="line"><span class="comment"># 截取的字符串为 /nekolr.com</span></span><br><span class="line"><span class="variable">$&#123;url#https:/&#125;</span></span><br><span class="line"><span class="comment"># 因为没有从第一个字符开始匹配，所以截取的字符串为 https://nekolr.com</span></span><br><span class="line"><span class="variable">$&#123;url#/&#125;</span></span><br><span class="line"><span class="comment"># 如果希望直到最后一个指定的子串再匹配结束，那么可以使用 `##`。  </span></span><br><span class="line">str=<span class="string">&quot;aBa@@--&quot;</span></span><br><span class="line"><span class="comment"># 截取的字符串为 @@--</span></span><br><span class="line"><span class="variable">$&#123;str##*a&#125;</span></span><br><span class="line"><span class="comment"># 截取的字符串为 https://nekolr.</span></span><br><span class="line"><span class="variable">$&#123;url%com*&#125;</span></span><br><span class="line"><span class="comment"># 将 path 变量内容的 sbin 取代成大写</span></span><br><span class="line"><span class="comment"># /usr/local/SBIN:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span></span><br><span class="line"><span class="variable">$&#123;path/sbin/SBIN&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="大小写转换"><a href="#大小写转换" class="headerlink" title="大小写转换"></a>大小写转换</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">your_name=<span class="string">&#x27;Alice&#x27;</span></span><br><span class="line"><span class="comment"># 小写转大写</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;your_name^^&#125;</span></span><br><span class="line"><span class="comment"># 大写转小写</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;your_name,,&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><p>bash 支持一维数组，但不支持多维数组，数组的大小没有限制。  </p>
<h2 id="定义数组"><a href="#定义数组" class="headerlink" title="定义数组"></a>定义数组</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">arr=(<span class="string">&quot;Java&quot;</span> <span class="string">&quot;Python&quot;</span> <span class="string">&quot;Ruby&quot;</span> <span class="string">&quot;Go&quot;</span>)</span><br><span class="line"><span class="comment"># shell 是弱类型的，不要求元素类型必须都相同</span></span><br><span class="line">arr=(12 <span class="string">&quot;Java&quot;</span> <span class="string">&quot;Go&quot;</span>)</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">arr[0]=<span class="string">&quot;Java&quot;</span></span><br><span class="line">arr[1]=<span class="string">&quot;Python&quot;</span></span><br><span class="line">arr[2]=<span class="string">&quot;Ruby&quot;</span></span><br><span class="line">arr[3]=<span class="string">&quot;Go&quot;</span></span><br></pre></td></tr></table></figure>

<p>定义数组无需给每个元素赋值，可以只给特定位置的元素赋值。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数组的长度为 3</span></span><br><span class="line">arr=([3]=24 [5]=19 [11]=33)</span><br></pre></td></tr></table></figure>

<h2 id="读取数组"><a href="#读取数组" class="headerlink" title="读取数组"></a>读取数组</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">arr=(<span class="string">&quot;Java&quot;</span> <span class="string">&quot;Python&quot;</span> <span class="string">&quot;Ruby&quot;</span> <span class="string">&quot;Go&quot;</span>)</span><br><span class="line"><span class="comment"># 获取第一个元素</span></span><br><span class="line"><span class="variable">$&#123;arr[0]&#125;</span></span><br><span class="line"><span class="comment"># 获取所有的元素</span></span><br><span class="line"><span class="variable">$&#123;arr[@]&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="获取数组长度"><a href="#获取数组长度" class="headerlink" title="获取数组长度"></a>获取数组长度</h2><p>获取数组长度的方法与获取字符串长度的方法一样。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">arr=([3]=<span class="string">&quot;Java&quot;</span> [5]=19 [11]=33)</span><br><span class="line"><span class="comment"># 获取数组元素的个数</span></span><br><span class="line">len=<span class="variable">$&#123;#arr[@]&#125;</span></span><br><span class="line"><span class="comment"># 获取数组元素的个数</span></span><br><span class="line">len=<span class="variable">$&#123;#arr[*]&#125;</span></span><br><span class="line"><span class="comment"># 获取某个元素的长度</span></span><br><span class="line">length=<span class="variable">$&#123;#arr[3]&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="删除数组元素"><a href="#删除数组元素" class="headerlink" title="删除数组元素"></a>删除数组元素</h2><p>在 shell 中使用 <code>unset</code> 删除数组元素。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">arr=([3]=<span class="string">&quot;Java&quot;</span> [5]=19 [11]=33)</span><br><span class="line"><span class="comment"># 删除下标为 3 的元素</span></span><br><span class="line"><span class="built_in">unset</span> arr[3]</span><br><span class="line"><span class="comment"># 删除整个数组</span></span><br><span class="line"><span class="built_in">unset</span> arr</span><br></pre></td></tr></table></figure>
<h2 id="数组拼接"><a href="#数组拼接" class="headerlink" title="数组拼接"></a>数组拼接</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr1=(23 55)</span><br><span class="line">arr2=(99 <span class="string">&quot;Java&quot;</span> <span class="string">&quot;Python&quot;</span>)</span><br><span class="line">arr_new=(<span class="variable">$&#123;arr1[@]&#125;</span> <span class="variable">$&#123;arr2[*]&#125;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="变量宣告"><a href="#变量宣告" class="headerlink" title="变量宣告"></a>变量宣告</h1><p>bash 中的变量默认都是字符串类型，如果需要非字符串类型的变量，就需要通过 <code>declare</code> 或 <code>typeset</code> 命令进行变量宣告，即声明变量的类型。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义数组</span></span><br><span class="line">$ <span class="built_in">declare</span> -a arr=(1 2 3)</span><br><span class="line"><span class="comment"># 定义整数类型</span></span><br><span class="line">$ <span class="built_in">declare</span> -i <span class="built_in">sum</span>=100+200+300</span><br><span class="line"><span class="comment"># 定义为只读类型</span></span><br><span class="line">$ <span class="built_in">declare</span> -r url=<span class="string">&quot;https://nekolr.com&quot;</span></span><br><span class="line"><span class="comment"># 定义环境变量</span></span><br><span class="line">$ <span class="built_in">declare</span> -x <span class="built_in">sum</span></span><br><span class="line"><span class="comment"># 单独列出变量的类型</span></span><br><span class="line">$ <span class="built_in">declare</span> -p <span class="built_in">sum</span></span><br><span class="line"><span class="comment"># 使用 + 号可以进行取消动作，这里取消作为环境变量</span></span><br><span class="line">$ <span class="built_in">declare</span> +x <span class="built_in">sum</span></span><br></pre></td></tr></table></figure>

<h1 id="键盘读取"><a href="#键盘读取" class="headerlink" title="键盘读取"></a>键盘读取</h1><p>使用 <code>read</code> 命令能够读取键盘输入的内容。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 参数 p 后面跟着提示信息</span></span><br><span class="line">$ <span class="built_in">read</span> -p <span class="string">&quot;请输入用户名：&quot;</span></span><br><span class="line"><span class="comment"># 读取输入的字符，并将值赋给 v1 变量</span></span><br><span class="line">$ <span class="built_in">read</span> v1</span><br><span class="line"><span class="comment"># 读取指定个数的字符，字符数目足够后自动返回并赋值</span></span><br><span class="line">$ <span class="built_in">read</span> -n 1 v1</span><br><span class="line"><span class="comment"># 关闭回显，可以用在输入密码时</span></span><br><span class="line">$ <span class="built_in">read</span> -s -p <span class="string">&quot;Enter your password:&quot;</span> pass</span><br><span class="line"><span class="comment"># 等待 5 秒后退出</span></span><br><span class="line">$ <span class="built_in">read</span> -t 5 -p <span class="string">&quot;Please enter your name:&quot;</span> name</span><br></pre></td></tr></table></figure>

<h1 id="数据流重导向"><a href="#数据流重导向" class="headerlink" title="数据流重导向"></a>数据流重导向</h1><p>数据流重导向就是将某个命令执行后要出现在屏幕上的数据（standard output 和 standard error output）传输到其他地方，例如：文件、打印机等。  </p>
<h2 id="标准输入和输出"><a href="#标准输入和输出" class="headerlink" title="标准输入和输出"></a>标准输入和输出</h2><table>
<thead>
<tr>
<th>名称</th>
<th>代码</th>
<th>使用</th>
</tr>
</thead>
<tbody><tr>
<td>标准输入（stdin）</td>
<td>0</td>
<td>使用 <code>&lt;</code> 或 <code>0&lt;</code> 覆盖，<code>&lt;&lt;</code> 或 <code>0&lt;&lt;</code> 追加。</td>
</tr>
<tr>
<td>标准输出（stdout）</td>
<td>1</td>
<td>使用 <code>&gt;</code> 或 <code>1&gt;</code> 覆盖，<code>&gt;&gt;</code> 或 <code>1&gt;&gt;</code> 追加。</td>
</tr>
<tr>
<td>标准错误输出（stderr）</td>
<td>2</td>
<td>使用 <code>2&gt;</code> 覆盖，<code>2&gt;&gt;</code> 追加。</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用一般用户账号搜寻 /home 底下是否有 .bashrc 文件</span></span><br><span class="line"><span class="comment"># 如果没有权限会有错误输出，将 stdout 和 stderr 分开存放到不同的文件</span></span><br><span class="line">$ find /home -name .bashrc &gt; list_right 2&gt; list_error</span><br><span class="line"><span class="comment"># 将数据全部写入同一个文件</span></span><br><span class="line">$ find /home -name .bashrc &gt; list 2&gt;&amp;1</span><br><span class="line">$ find /home -name .bashrc &amp;&gt; list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 首先演示如何使用 cat 创建文件</span></span><br><span class="line"><span class="comment"># 使用该命令后，通过键盘输入内容，按 ctrl + d 结束</span></span><br><span class="line">$ <span class="built_in">cat</span> &gt; catfile</span><br><span class="line"><span class="comment"># 使用该命令后，通过键盘输入内容，当键盘输入 eof 后会自动结束</span></span><br><span class="line">$ <span class="built_in">cat</span> &gt; catfile &lt;&lt; <span class="string">&quot;eof&quot;</span></span><br><span class="line"><span class="comment"># 使用文件内容取代键盘输入</span></span><br><span class="line">$ <span class="built_in">cat</span> &gt; catfile &lt; ~/.bashrc</span><br></pre></td></tr></table></figure>

<p>这里需要注意的是，<code>cmd &gt; file 2&gt;&amp;1</code> 中的 <code>&amp;</code> 表示重定向的目标不是某个文件，而是一个<strong>文件描述符</strong>，换句话说就是 <code>2&gt;&amp;1</code> 表示将 stderr 重定向到文件描述符为 1 的文件（即 &#x2F;dev&#x2F;stdout，这个文件就是 stdout 在文件系统中的映射）中，而 <code>&amp;&gt; file</code> 是另一种写法。  </p>
<h2 id="垃圾桶"><a href="#垃圾桶" class="headerlink" title="垃圾桶"></a>垃圾桶</h2><p>如果提前知道有错误信息会输出，想要将错误信息忽略掉或者不存储时，可以使用 <code>/dev/null</code> 文件。该文件是一个特殊的文件，写入到它的内容都会被丢弃，如果尝试读取它的内容，那么什么也读不到。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将错误的数据丢弃，屏幕只会显示正确的信息</span></span><br><span class="line">$ find /home -name .bashrc 2&gt; /dev/null</span><br></pre></td></tr></table></figure>

<h1 id="命令运行的判断依据"><a href="#命令运行的判断依据" class="headerlink" title="命令运行的判断依据"></a>命令运行的判断依据</h1><p>很多时候我们想要一次运行很多条命令，除了使用 shell 脚本，另一种方式就是使用多重命令。  </p>
<p>在不用考虑命令的相关性时，连续下达命令。使用 <code>cmd;cmd</code> 的形式，比如：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在关机前执行两次同步写入磁盘</span></span><br><span class="line">$ <span class="built_in">sync</span> ; <span class="built_in">sync</span> ; shutdown -h now</span><br></pre></td></tr></table></figure>

<p>如果一个命令的运行需要另一个命令先执行，则可以使用 <code>cmd &amp;&amp; cmd</code> 或者 <code>cmd || cmd</code> 的形式下达命令。  </p>
<table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>cmd1 &amp;&amp; cmd2</td>
<td>如果 cmd1 运行完毕且正确执行（命令回传 <code>$?</code> 的值为 0），则执行 cmd2；否则不执行 cmd2</td>
</tr>
<tr>
<td>cmd1 &amp;#124;&amp;#124; cmd2</td>
<td>如果 cmd1 运行完毕且正确执行，则 cmd2 不执行；否则执行 cmd2</td>
</tr>
</tbody></table>
<h1 id="管线命令"><a href="#管线命令" class="headerlink" title="管线命令"></a>管线命令</h1><p>如果命令输出的内容必须经过处理才能得到我们想要的格式，那么此时就需要用到管线命令（pipe）。需要注意的是，管线命令与连续下达命令是不一样的。  </p>
<p>管线命令使用的是 <code>|</code> 这个界定符号，它只能处理前面的命令传递过来的 stdout。每个管线后面的第一个数据必定是命令，而且这个命令必须能够接受 stdin 的数据。比如：<code>less</code>、<code>more</code>、<code>head</code>、<code>tail</code> 等命令可以接受 stdin 的数据，而 <code>ls</code>、<code>cp</code>、<code>mv</code> 等就不是管线命令了。  </p>
<h2 id="cut"><a href="#cut" class="headerlink" title="cut"></a>cut</h2><p><code>cut</code> 命令主要用来切割文件内容。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 参数 d 代表的是分隔符，参数 f 代表的当使用分隔符切割后的第几段</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$PATH</span> | <span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f 3,4</span><br><span class="line">/usr/local/bin:/usr/sbin</span><br><span class="line"><span class="comment"># 取出第 10 个字符以后所有的字符串</span></span><br><span class="line">$ <span class="built_in">export</span> | <span class="built_in">cut</span> -c 10-</span><br></pre></td></tr></table></figure>

<h2 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h2><p><code>grep</code> 命令主要用来筛选匹配的数据。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据关键字筛选</span></span><br><span class="line">$ netstat -tunlp | grep java</span><br><span class="line"><span class="comment"># 反向选择，选出不包含关键字的内容</span></span><br><span class="line">$ netstat -tunlp | grep -v java</span><br><span class="line"><span class="comment"># 取出 /etc/man.config 文件内容中包含 MANPATH 的那几行</span></span><br><span class="line">$ grep --color=auto MANPATH /etc/man.config</span><br></pre></td></tr></table></figure>

<h2 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h2><p><code>sort</code> 命令主要用来对数据进行排序。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按字典顺序排序</span></span><br><span class="line">$ <span class="built_in">cat</span> /etc/passwd | <span class="built_in">sort</span></span><br><span class="line"><span class="comment"># /etc/passwd 的内容都是以 : 分隔的，如何以第三栏排序</span></span><br><span class="line">$ <span class="built_in">cat</span> /etc/passwd | <span class="built_in">sort</span> -t <span class="string">&quot;:&quot;</span> -k 3</span><br></pre></td></tr></table></figure>

<h2 id="uniq"><a href="#uniq" class="headerlink" title="uniq"></a>uniq</h2><p><code>uniq</code> 命令主要用来去重。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 排序完成后，将重复的数据仅显示一份</span></span><br><span class="line">$ last | <span class="built_in">cut</span> -d <span class="string">&quot; &quot;</span> -f 1 | <span class="built_in">sort</span> | <span class="built_in">uniq</span></span><br><span class="line"><span class="comment"># 在上面的基础上计数</span></span><br><span class="line">$ last | <span class="built_in">cut</span> -d <span class="string">&quot;&quot;</span> -f 1 | <span class="built_in">sort</span> | <span class="built_in">uniq</span> -c</span><br></pre></td></tr></table></figure>

<h2 id="wc"><a href="#wc" class="headerlink" title="wc"></a>wc</h2><p><code>wc</code> 命令主要用来统计文件的行数、字符数等信息。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出文件中有多少行、多少字（英文单字）、多少字符</span></span><br><span class="line">$ <span class="built_in">cat</span> /etc/man.config | <span class="built_in">wc</span></span><br><span class="line"><span class="comment"># 仅列出行</span></span><br><span class="line">$ <span class="built_in">cat</span> /etc/man.config | <span class="built_in">wc</span> -l</span><br><span class="line"><span class="comment"># 仅列出单字</span></span><br><span class="line">$ <span class="built_in">cat</span> /etc/man.config | <span class="built_in">wc</span> -w</span><br><span class="line"><span class="comment"># 仅列出字符</span></span><br><span class="line">$ <span class="built_in">cat</span> /etc/man.config | <span class="built_in">wc</span> -m</span><br></pre></td></tr></table></figure>

<h2 id="tee"><a href="#tee" class="headerlink" title="tee"></a>tee</h2><p><code>tee</code> 命令会同时将数据流发送到文件和屏幕，而输出到屏幕的，其实就是 stdout，因此后面可以继续使用管线命令。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将 last 命令的输出保存一份到文件中</span></span><br><span class="line">$ last | <span class="built_in">tee</span> last.list | <span class="built_in">cut</span> -d <span class="string">&quot; &quot;</span> -f 1</span><br><span class="line"><span class="comment"># 以累加的方式输出</span></span><br><span class="line">$ last | <span class="built_in">tee</span> -a last.list | <span class="built_in">cut</span> -d <span class="string">&quot; &quot;</span> -f 1</span><br></pre></td></tr></table></figure>

<h2 id="tr"><a href="#tr" class="headerlink" title="tr"></a>tr</h2><p><code>tr</code> 命令可以用来删除或替换一段数据中的某些内容。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将所有内容小写转大写</span></span><br><span class="line">$ last | <span class="built_in">tr</span> <span class="string">&#x27;[a-z]&#x27;</span> <span class="string">&#x27;[A-Z]&#x27;</span></span><br><span class="line"><span class="comment"># 删除所有的冒号</span></span><br><span class="line">$ <span class="built_in">cat</span> /etc/passwd | <span class="built_in">tr</span> -d <span class="string">&quot;:&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="col"><a href="#col" class="headerlink" title="col"></a>col</h2><p><code>col</code> 命令可以用来将内容中的 Tab 转换为对等的空格。  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将文件中的 Tab 转换为空格</span></span><br><span class="line">$ <span class="built_in">cat</span> /etc/man.config | col -x | <span class="built_in">cat</span> -A | more</span><br></pre></td></tr></table></figure>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/24744565">DOS 系统和 Windows 系统有什么关系？</a>  </p>
</blockquote>
<blockquote>
<p>《鸟哥的Linux私房菜》</p>
</blockquote>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Shell/" rel="tag"># Shell</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2018/12/27/Java%20%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86/" rel="prev" title="Java 垃圾收集">
                  <i class="fa fa-chevron-left"></i> Java 垃圾收集
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2019/01/22/%E7%94%B3%E8%AF%B7%E6%B3%9B%E5%9F%9F%E5%90%8D%E8%AF%81%E4%B9%A6/" rel="next" title="申请泛域名证书">
                  申请泛域名证书 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">nekolr</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>



  <script src="/js/third-party/fancybox.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","mhchem":false,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
