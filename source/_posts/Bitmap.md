---
title: Bitmap
date: 2019/8/27 15:58:0
tags: [算法]
categories: [算法]
---
先考虑一个问题：有 40 亿个不重复且无序的无符号整数，如何判断一个整数是否在这 40 亿个整数中，要求使用的内存不超过 2GB。

<!--more-->

假设使用 Java 语言，由于一个 int 类型的整数占用 4 个字节，如果使用 int 类型来存储这些数据，40 亿个整数占用大概 14.9GB（`40 亿 * 4/1024/1024/1024`）的内存，很明显这是不符合要求的。一个常规的思路就是将 40 亿个整数分片，每次读取一个分片到内存中进行判断。如果我们一定要一次性将这些数据存放到不超过 2GB 的内存中呢？这时我们就需要用到一个特殊的算法，这就是 Bitmap 算法。

# Bitmap
在《编程珠玑》中提到，所谓的 Bitmap 就是使用一个 bit 位来标记某个元素对应的 value，而 key 就是该元素。由于数据使用 bit 为单位来存储，因此需要的存储空间可以被大幅度地压缩。

从字面上好像不太好理解这个定义，下面通过一个例子来详细说明。假如我们需要对 0 到 7 之间的五个整数 `5 3 7 6 4` 进行排序，这五个整数没有重复。根据定义，要表示 8 个数就需要 8 bit 的存储空间。我们首先开辟 1 byte 的空间，然后将这个空间中所有的 bit 位都置为 0。接下来遍历整数集合，第一个元素为 5 ，则将 5 对应的位置置为 1。

![第一次遍历](https://img.nekolr.com/images/2019/08/27/RRl.png)

